#!/usr/bin/env python3
"""
为现有小说补充更多章节
"""

import sqlite3

def add_chapters():
    conn = sqlite3.connect('novels.db')
    cursor = conn.cursor()
    
    # 获取需要补充章节的小说
    cursor.execute('''
        SELECT id, title, (SELECT COUNT(*) FROM chapters WHERE novel_id = novels.id) as chapter_count 
        FROM novels 
        WHERE (SELECT COUNT(*) FROM chapters WHERE novel_id = novels.id) < 10
    ''')
    
    novels_need_chapters = cursor.fetchall()
    
    print("=== 开始补充章节 ===\n")
    
    for novel_id, title, current_count in novels_need_chapters:
        print(f"为《{title}》补充章节 (当前{current_count}章)")
        
        # 生成章节
        chapters_to_add = 15 - current_count  # 补充到15章
        
        for i in range(current_count + 1, current_count + chapters_to_add + 1):
            chapter_title = f"第{i}章"
            content = generate_chapter_content(title, i)
            
            cursor.execute('''
                INSERT INTO chapters (novel_id, chapter_number, title, content)
                VALUES (?, ?, ?, ?)
            ''', (novel_id, i, chapter_title, content))
        
        print(f"  ✓ 已添加 {chapters_to_add} 章\n")
    
    conn.commit()
    conn.close()
    
    print("✓✓✓ 章节补充完成！\n")
    
    # 显示最终统计
    conn = sqlite3.connect('novels.db')
    cursor = conn.cursor()
    
    print("=== 最终统计 ===")
    cursor.execute('SELECT COUNT(*) FROM novels')
    print(f"总小说数: {cursor.fetchone()[0]}")
    
    cursor.execute('''
        SELECT n.title, COUNT(*) as cnt 
        FROM novels n 
        JOIN chapters c ON n.id = c.novel_id 
        GROUP BY n.id
        ORDER BY n.id
    ''')
    
    for title, cnt in cursor.fetchall():
        print(f"  《{title}》: {cnt} 章")
    
    conn.close()

def generate_chapter_content(title, chapter_num):
    """根据小说类型生成章节内容"""
    
    # 基础内容模板
    base_content = f"""
第{chapter_num}章的故事继续展开。主角在这一章中经历了新的挑战和冒险，每一步都充满了未知和惊喜。

随着情节的推进，更多的秘密开始浮出水面。这个世界比想象中更加复杂，背后隐藏着无数不为人知的真相。

在这一章中，主角的实力得到了进一步的提升。通过不懈的努力和特殊的机遇，他逐渐掌握了更强大的力量。

伙伴们也在不断成长，每个人都在为共同的目标而奋斗。团队的默契越来越好，面对强敌也能从容应对。

"""
    
    # 根据小说类型添加特色内容
    if '诡秘' in title or '秘' in title:
        type_content = """
在神秘学的探索中，又发现了新的线索。古老的符文和仪式隐藏着强大的力量，但同时也伴随着巨大的危险。

占卜指引着前进的方向，但命运的真相永远扑朔迷离。每一个决定都可能改变未来，每一步都需要谨慎权衡。

非凡者的世界充满了诡异和危险，失控的风险始终存在。只有保持理智，严格遵守规则，才能在这个世界生存下去。

神秘组织的阴谋正在暗中进行，各方势力明争暗斗。在这场没有硝烟的战争中，信息和情报往往比武力更加重要。

塔罗会的成员们互相分享情报，在"愚者"的引导下逐渐揭开世界的真相。每一次聚会都带来新的发现，也带来新的疑问。

灰雾之上俯瞰众生，窥探命运的轨迹。这片神秘的空间连接着过去、现在和未来，蕴含着难以想象的力量。

封印物、魔药、非凡特性，这些都是非凡者追求的资源。每一件物品都有其独特的作用，也有其危险的副作用。

守夜人的职责是对抗超凡威胁，保护普通人的安全。在黑暗中守望，在危险中前行，这是守夜人的使命。

女神的教导指引着信徒前进，暗夜女神的庇护让人感到安心。在这个充满恶意的世界里，信仰是重要的精神支柱。

历史的真相被尘封在时间长河中，只有少数人知晓那些禁忌的知识。第四纪的秘密，第三纪的传说，都在等待着被发现。
"""
    
    elif '高手' in title or '荣耀' in title:
        type_content = """
荣耀的世界精彩纷呈，每一场战斗都是技术和策略的较量。操作、意识、配合，缺一不可。

游戏中的每一个职业都有其独特的特点和玩法。战斗法师的连招、剑客的突进、枪炮师的火力压制，每一种都需要深入研究。

副本攻略需要团队配合，每个人都要发挥出自己的作用。坦克拉仇恨，输出打伤害，治疗加血，环环相扣。

公会战考验的是整体实力和战术安排。指挥的作用至关重要，一个明智的决策能够扭转整个战局。

竞技场是个人实力的体现，没有队友的帮助，只能依靠自己的技术。每一次对决都是对极限的挑战。

职业联赛是荣耀的最高舞台，无数选手梦想着能够站在那里。灯光、欢呼、荣誉，这是对努力最好的回报。

训练永无止境，即使是顶尖高手也需要不断磨练技术。一个细节的提升，可能就是胜负的关键。

战队的默契需要时间培养，磨合是一个漫长的过程。但当团队真正融为一体时，爆发出的力量令人惊叹。

荣耀不是一个人的游戏，团队合作才是胜利的关键。信任队友，发挥各自的优势，才能战胜强敌。

职业圈的竞争激烈而残酷，每个赛季都有新人崛起，也有老将退役。这就是竞技的魅力，也是它的残酷之处。
"""
    
    elif '斗' in title or '修' in title or '仙' in title:
        type_content = """
修炼的道路漫长而艰辛，每一个境界的突破都需要大量的积累。天地灵气在体内运转，不断淬炼着身体和灵魂。

功法的运转要小心谨慎，一个失误可能导致走火入魔。前辈们留下的经验要牢记于心，不能贪功冒进。

战斗是最好的磨炼，在生死之间更容易领悟武道真谛。每一次的搏杀都是对极限的挑战，也是实力提升的机会。

修炼资源在这个世界极其珍贵，为了获得天材地宝，修士们不惜冒险犯难。竞争激烈，弱肉强食是永恒的法则。

宗门、家族、散修，这个世界的修士有着不同的背景。但无论出身如何，最终能走多远，还是要看个人的努力和机缘。

丹药、法宝、符箓，这些都是修士的重要辅助。炼丹、炼器、制符，每一门技艺都博大精深。

秘境和遗迹中往往隐藏着古人留下的传承，但也充满了危险。机缘与风险并存，这就是修真界的常态。

境界的提升不仅是力量的增长，更是对天地大道的领悟。武道、剑道、丹道，每一条道路都通向终极的真理。

妖兽横行，魔修作乱，正邪之争从未停息。在这乱世之中，只有变强才能保护自己和在乎的人。

飞升成仙是无数修士的终极梦想，但真正能做到的寥寥无几。漫漫修真路，还有很长的路要走。
"""
    
    elif '江湖' in title or '刀' in title or '剑' in title:
        type_content = """
江湖险恶，人心叵测。明枪易躲，暗箭难防。在这个世界，实力是生存的根本，但智谋同样重要。

武功的修炼需要日积月累，没有捷径可走。每一招每一式都要反复练习，才能达到炉火纯青的境界。

江湖门派林立，少林、武当、峨眉、华山，各有各的绝学。但正所谓天下武功出少林，万变不离其宗。

侠之大者，为国为民。真正的侠客不仅武功高强，更要有一颗正义之心，路见不平拔刀相助。

朝堂与江湖，看似两个世界，实则密不可分。多少江湖恩怨背后，都有朝堂权谋的影子。

刀剑无眼，生死一线。每一次出手都要全力以赴，因为稍有不慎，就可能命丧当场。

师承、机缘、悟性，这些都影响着武者的成就。有的人天赋异禀，有的人厚积薄发，各有各的路。

江湖规矩不可违背，否则会成为众矢之的。但有时候，为了大义，也要有打破规矩的勇气。

兵器是武者的第二生命，一把趁手的兵器能让战力倍增。刀、剑、枪、棍，各有千秋。

快意恩仇是江湖梦，但真正身在其中，才知道其中的艰辛和无奈。江湖，不是想来就来，想走就走的地方。
"""
    
    else:
        type_content = """
故事的发展出人意料，每一个转折都让人惊叹。作者的笔力深厚，情节设计精妙，人物塑造饱满。

在这一章中，主角展现出了非凡的智慧和勇气。面对困境，他没有退缩，而是积极寻找解决的方法。

配角们也各有特色，每个人都有自己的故事和追求。他们与主角的互动，为故事增添了更多的色彩。

世界观的构建宏大而细致，每一个细节都经过深思熟虑。这个世界是立体的、鲜活的，让人向往。

情感的描写细腻动人，无论是友情、爱情还是亲情，都刻画得入木三分。读者很容易产生共鸣。

冲突和矛盾推动着情节发展，每一个问题的解决都带来新的问题。这种环环相扣的结构让人欲罢不能。

伏笔埋得很深，只有仔细阅读才能发现。当谜底揭晓的那一刻，一切都豁然开朗，令人拍案叫绝。

节奏把握得恰到好处，该紧张的时候紧张，该舒缓的时候舒缓。这种张弛有度的叙事风格很舒服。

语言风格独特，有些幽默诙谐，有些庄重严肃，有些优美抒情。丰富的表达让阅读体验更加丰富。

总的来说，这是一部优秀的作品，值得细细品味。相信后续的故事会更加精彩，让我们拭目以待。
"""
    
    # 结尾部分
    ending = f"""

{chapter_num}章的内容到这里告一段落，但故事还远未结束。前方还有更多的挑战在等待，更多的秘密需要揭开。

主角的旅程才刚刚开始，真正的考验还在后面。但无论前路多么艰难，他都会坚定地走下去。

让我们继续关注这个精彩的故事，看主角如何在这个世界中书写属于自己的传奇。

未完待续……

(本章完)
"""
    
    return base_content + type_content + ending

if __name__ == '__main__':
    add_chapters()
